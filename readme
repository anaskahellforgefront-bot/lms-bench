ðŸ“˜ LMS Elite: System Architecture & Data Structure ReportProject Name: LMS Elite (Library Management System)Framework: Frappe Framework (Python/JS/MariaDB)Version: 1.0.0 (Production Ready)Date: December 29, 20251. Executive SummaryLMS Elite is a modern, bilingual (English/Arabic), and full-featured Library Management System. It allows users to browse a physical book collection, subscribe to membership tiers, borrow books, join waiting lists (queues), and consume educational content via a blog.The system is built on a relational database architecture where user operations (Loans, Transactions) are strictly linked to Membership profiles and Book inventory status.2. Core Database Schema (DocTypes)The database is organized into four logical modules: Settings, Membership, Library Operations, and Content Management (CMS).A. System Configuration (Singletons)Global configurations that control system behavior.1. LMS Settings (Single DocType)Purpose: Stores global variables used across the system.Key Fields:reservation_fee (Currency): Cost to join a book queue (currently 20.0).daily_fine (Currency): Penalty per day for overdue books (currently 10.0).support_email / support_phone: Displayed in the UI footer.address_en / address_ar: Physical library location.B. Membership ModuleHandles user tiers and privileges.2. LMS Membership Type (Master Data)Purpose: Defines the subscription plans.Records: 3 Active Plans (Standard, Gold, Elite).Key Fields:tier_name / tier_name_ar: Bilingual names (e.g., "Elite" / "Ø§Ù„Ù†Ø®Ø¨Ø©").price: Cost of subscription (0 for Standard, 500 for Elite).max_books: Hard limit on concurrent loans (3 to 25 books).max_days: Loan duration limit (14 to 60 days).features_en / features_ar: HTML content describing perks.3. LMS Member (Transactional Master)Purpose: The bridge between the system User and library logic.Relationships: Links 1:1 with User.Key Fields:user (Link): Reference to the system login email.membership_type (Link): Current plan (e.g., "Gold").total_unpaid_fines (Float): Accumulator for penalties.status: Active/Banned.C. Library Inventory ModuleThe core assets of the system.4. LMS Book (Master Data)Purpose: Stores book metadata, stock, and availability.Records: 18 High-Quality Entries (e.g., Clean Code, Sapiens, Dune).Key Fields:Bilingual Metadata: title, title_ar, author, author_ar, description, description_ar.category (Select): Programming, Fiction, History, etc.status (Select): Available, Borrowed, Reserved.total_copies / available_copies (Int): Inventory tracking.rating (Float): Average user rating (4.0 - 5.0).cover_image: URL/Path to the visual cover.D. Operations Module (Transactional)Tracks the movement of books and money.5. LMS LoanPurpose: Represents an active or historical borrowing session.Key Fields:book (Link -> LMS Book)member (Link -> LMS Member)loan_date / return_date: Tracks duration.status: Active (Book is out), Returned (History), Overdue.6. LMS QueuePurpose: Manages waiting lists for out-of-stock books.Key Fields:book (Link)member (Link)status: Waiting (In line), Ready to Pickup (Book is available), Completed.requested_at: Timestamp for queue priority.7. LMS TransactionPurpose: Financial ledger for the library.Key Fields:type: "Membership Fee", "Reservation Fee", "Wallet Payment".amount: Value in EGP.reference: Invoice ID (e.g., "INV-9028").E. Content Management (CMS)Marketing and user engagement tools.8. LMS Blog & LMS Blog CommentPurpose: SEO and educational content.Data: 5 active articles (e.g., "The Psychology of Habits") with 10 comments.Features: HTML Content, Cover Images, Tags, Read Time.9. LMS TestimonialPurpose: Social proof for the landing page.Data: 6 reviews with real user images and ratings (4-5 stars).10. LMS FAQPurpose: Help center data.Data: 4 bilingual entries covering Borrowing, Membership, and Fines.3. System Logic & Workflows1. The Borrowing CycleCheck: User selects a book. System checks available_copies > 0.Validate: System checks if User active_loans < membership.max_books.Action: User clicks "Borrow" -> OTP sent -> OTP Confirmed.Record:LMS Loan created with status "Active".LMS Book status updated to "Borrowed" (if copies hit 0).available_copies decreased by 1.2. The Reservation (Queue) CycleCondition: Book status is "Borrowed" or "Reserved".Action: User clicks "Join Queue".Financial: LMS Transaction created for Reservation Fee (defined in Settings).Record: LMS Queue entry created with status "Waiting".3. The Return LogicAction: User clicks "Return".Update:LMS Loan status changes to "Returned".LMS Book available_copies increased by 1.Queue Check: If LMS Queue has "Waiting" users for this book:Book status becomes "Reserved".Queue entry changes to "Ready to Pickup".Book is not made available to the public yet.4. Current Data Snapshot (Deployment State)The system is currently populated with "World-Class" Data to simulate a live production environment:ModuleCountDetailsUsers7Includes Admin, Staff, and demo Members.Books18Best-sellers (Clean Code, Atomic Habits, etc.) with covers.Memberships3Tiered pricing (0, 200, 500 EGP).Transactions6Financial history including membership fees and fines.ActivityMixedActive loans, returned history, and queue entries exist.MarketingRich5 Blogs, 6 Testimonials, 4 FAQs fully populated.5. Technical Requirements for ReplicationTo replicate this project on another Frappe Bench:Dependencies:Frappe Framework v15+Python 3.10+Redis & MariaDBCustom Fields Required:User Doctype: Must add bio (Small Text) field.Installation Steps:Create a new site.Install the lms_portal app.Run bench migrate.Execute the provided "Phase 1 to 4" injection scripts to populate the database.6. ConclusionThe LMS Elite system is structurally sound. The separation of Configuration (LMS Settings, Membership Type), Inventory (LMS Book), and Activity (Loan, Transaction) allows for scalability.The issue previously encountered regarding "Active Loan" detection was resolved by correctly mapping the session User (email) to the LMS Member (ID) before querying the LMS Loan table.Status: System is fully operational, populated with data, and ready for demonstration or deployment.

